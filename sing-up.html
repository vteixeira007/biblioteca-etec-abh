<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cadastro | Biblioteca ETEC</title>
  <link rel="stylesheet" href="./dev/css/main.css" />
</head>

<body style="grid-template-columns: 1fr !important;">
  <main style="margin: 0 !important;">
    <div class="login-page">
      <div class="login-container">
        <div class="login-box">
          <h1>Cadastre um novo usuário!</h1>

          <form id="register-form">
            <div class="input-group name-group">
              <input type="text" id="register-login" placeholder="Nome de usuário" required />
            </div>

            <div class="input-group password-group">
              <input type="password" id="register-password" placeholder="Senha" required />
            </div>

            <div class="input-group password-group">
              <input type="password" placeholder="Confirme a senha" />
            </div>

            <button type="submit" class="login-button">Cadastrar</button>

            <p class="register">
              Já possui uma conta?
              <a href="#login-section" class="register-link">Faça Login</a>
            </p>
          </form>
        </div>
      </div>
    </div>
  </main>
  <script src="./assets/js/cadastro.js"></script>
  <script>
    const registerForm = document.getElementById("register-form");
    
    registerForm.addEventListener("submit", async (e) => {
      e.preventDefault();

      const login = document.getElementById("register-login").value;
      const password = document.getElementById("register-password").value;

      try {
        const response = await fetch("http://localhost:8090/auth/register", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({
            login: login,
            password: password,
            userRole: "USER"
          })
        });

        const data = await response.text();
        alert("Cadastro realizado com sucesso!");
        console.log("Cadastro:", data);
      } catch (error) {
        console.error("Erro no cadastro:", error);
        alert("Erro ao cadastrar.");
      }
    });
  </script>
</body>

</html>